<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>Transliterator</title>
  <link rel="shortcut icon" href="favicon.png">
  <link rel="stylesheet" href="vendor/stylesheets/semantic.min.css">
  <link rel="stylesheet" href="stylesheets/layout.css">
  <link rel="stylesheet" href="stylesheets/scrollbar.css">
  <script src="vendor/javascripts/howler.min.js"></script>
  <script src="vendor/javascripts/jquery-3.2.0.min.js"></script>
  <script src="vendor/javascripts/clipboard.min.js"></script>
  <script src="vendor/javascripts/moment.js"></script>
  <script src="vendor/javascripts/semantic.min.js"></script>
  <script src="vendor/javascripts/sugar.js"></script>
  <script src="vendor/javascripts/underscore.min.js"></script>
  <script src="vendor/javascripts/vue.js"></script>
  <script src="javascripts/transliterator.js"></script>
  <script src="tests/var.js"></script>
  <script src="tests/alphabet-with-vowels.js"></script>
  <script src="tests/superscribed.js"></script>
  <script src="tests/subscribed.js"></script>
  <script>
    $(function() {
      Vue.component('test-result', {
        props: {
          test: Object
        },
        template: `
          <div class="ui gray label test">
            <span class="tibetan">{{test.tibetan}}</span>
            <span>{{test.transliteration}}</span>
            <span>
              <i v-if=" test.pass" class="check green icon"></i>
              <i v-if="!test.pass" class="times red icon"></i>
            </span>
          </div>
        `
      })
      Vue.component('results-group', {
        props: {
          name: String,
          tests: Array
        },
        data: function() {
          var ranTests = this.tests.each(function(test) {
            test.transliterated = new Transliterator(test.tibetan).transliterate();
            test.pass = test.transliterated == test.transliteration;
          });
          var allPassed = ranTests.all(function(test) { return test.pass });
          return {
            ranTests: ranTests,
            allPassed: allPassed,
            opened: allPassed
          }
        },
        template: `
          <div
            class="ui inverted segment results-group"
            v-on:click="opened=!opened"
            >
            <div class="header">
              {{name}}
              <i v-if=" allPassed" class="check green icon"></i>
              <i v-if="!allPassed" class="times red icon"></i>
            </div>
            <test-result
              v-if="!opened"
              v-for="(test, index) in ranTests"
              v-bind:test="test"
              v-bind:key="index"
            >
            </test-result>
          </div>
        `
      })
      new Vue({
        el: '#main',
        data: {
          tests: tests
        },
        template: `
          <div>
            <results-group
             v-for="test in tests"
             v-bind:name="test.name"
             v-bind:tests="test.tests">
            </results-group>
          </div>
        `
      })
    })
  </script>
  <style>
  </style>
  <body>
    <div id="main" class="ui container"></div>
  </body>
</html>